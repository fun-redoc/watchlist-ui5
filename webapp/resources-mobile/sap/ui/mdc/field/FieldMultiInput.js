/*!
 * OpenUI5
 * (c) Copyright 2009-2024 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Element","sap/m/MultiInput","sap/ui/mdc/field/FieldMultiInputRenderer","sap/ui/Device","sap/m/Tokenizer"],(e,t,i,n,o)=>{"use strict";const s=t.extend("sap.ui.mdc.field.FieldMultiInput",{metadata:{library:"sap.ui.mdc",properties:{ariaAttributes:{type:"object",defaultValue:{},byValue:true}}},renderer:i});s.prototype.init=function(){t.prototype.init.apply(this,arguments);const e=this.getAggregation("tokenizer");e._fillClipboard=a;e._handleNMoreIndicator=function(e){const t=this.getBinding("tokens");const i=t.getLength();const n=this.getTokens().length;const s=i-n;return o.prototype._handleNMoreIndicator.apply(this,[e+s])};e._handleNMoreIndicatorPress=function(){const e=this.getParent();l.call(e);return o.prototype._handleNMoreIndicatorPress.apply(this,arguments)}};s.prototype.onfocusin=function(e){if(e.srcControl.isA("sap.m.Token")){const t=this.indexOfToken(e.srcControl);if(t>=0){this._iRestoreTokenFocus=this.getTokens().length-t}if(this._oUpdateBindingTimer||this._bUpdateBinding){this.bDeletePressed=false;this.iFocusedIndexBeforeUpdate=0}l.call(this,true)}else{l.call(this,false)}t.prototype.onfocusin.apply(this,arguments)};s.prototype.onAfterRendering=function(){const{bDeletePressed:e,bTokensUpdated:i}=this;const n=this.iFocusedIndexBeforeUpdate;if(this._oUpdateBindingTimer){this.bTokensUpdated=false;this.bDeletePressed=false}else if(this._bUpdateBinding&&this._iRestoreTokenFocus!==undefined){this.iFocusedIndexBeforeUpdate=this.getTokens().length-this._iRestoreTokenFocus;delete this._iRestoreTokenFocus;delete this._bUpdateBinding;this.bDeletePressed=true;const e=this.getAggregation("tokenizer");if(e._oSelectionOrigin){e._oSelectionOrigin=e.getTokens()[this.iFocusedIndexBeforeUpdate]}}t.prototype.onAfterRendering.apply(this,arguments);if(this._oUpdateBindingTimer||this._bUpdateBinding){this.bDeletePressed=e;this.iFocusedIndexBeforeUpdate=n;this.bTokensUpdated=i}};s.prototype.shouldSuggetionsPopoverOpenOnMobile=function(i){const n=this.getParent();const o=n?.getValueHelp?.();const s=o&&e.getElementById(o);if(s?.getTypeahead()){return false}else{return t.prototype.shouldSuggetionsPopoverOpenOnMobile.apply(this,arguments)}};let r=false;async function a(e){if(!navigator.clipboard){throw new Error(this+" requires a secure context in order to access the clipboard API.")}if(!r){const e=this.getSelectedTokens();if(e.length===0){return}r=true;const t=this.getBindingInfo("tokens").model;const i=e.map(e=>{const i=e.getBinding("text").getType();const n=e.getBindingContext(t).getObject();return i.getTextForCopy(n)}).join("\r\n");const n="<table><tr>"+e.map(e=>"<td>"+e.getText()+"</td>").join("</tr><tr>")+"</tr></table>";if(d()){const e="text/html";const t="text/plain";const o=new ClipboardItem({[t]:new Blob([i],{type:t}),[e]:new Blob([n],{type:e})});await navigator.clipboard.write([o])}else{await navigator.clipboard.writeText(i)}if(r){r=false}}}function d(){return Boolean(n.system.desktop&&window.ClipboardItem&&navigator.clipboard?.write)}function l(e){const t=this.getBindingInfo("tokens");if(!this._oUpdateBindingTimer&&(t.length||t.startIndex)){const i=()=>{let e=t.template;if(t.hasOwnProperty("templateShareable")&&!t.templateShareable){e=e.clone()}this._bUpdateBinding=true;this.bindAggregation("tokens",{path:t.path,model:t.model,template:e})};if(e){const e=this.getBinding("tokens");const n=e.getLength();if(n>=t.length){this._oUpdateBindingTimer=setTimeout(()=>{delete this._oUpdateBindingTimer;i()},200)}}else{i()}}}return s});
//# sourceMappingURL=FieldMultiInput.js.map