/*!
 * OpenUI5
 * (c) Copyright 2009-2024 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./BaseFilter","sap/ui/integration/controls/ComboBox","sap/ui/core/ListItem","sap/ui/model/json/JSONModel","sap/ui/integration/util/BindingResolver","sap/ui/integration/util/ComboBoxHelper","sap/base/util/merge"],function(e,t,o,i,a,l,s){"use strict";const n=e.extend("sap.ui.integration.cards.filters.ComboBoxFilter",{metadata:{library:"sap.ui.integration",aggregations:{_comboBox:{type:"sap.m.ComboBox",multiple:false,visibility:"hidden"}}},renderer:{apiVersion:2}});n.prototype.exit=function(){e.prototype.exit.apply(this,arguments);if(this._oItemTemplate){this._oItemTemplate.destroy()}};n.prototype.getField=function(){return this._getComboBox()};n.prototype.onDataChanged=function(){const e=this._getComboBox();l.setValueAndKey(e,e.getSelectedKey(),e.getValue());this._syncValue()};n.prototype.getValueForModel=function(){const e=this._getComboBox();let t=e.getSelectedItem();const o=e.getCustomSelectedIndex();if(!t&&o>-1){t=this._getComboBox().getItems()[o];if(t&&!this._getComboBox().getValue()){e.setSelectedItem(t)}}if(t){return{value:this._getComboBox().getValue(),selectedItem:{title:t.getText(),key:t.getKey(),additionalText:t.getAdditionalText()}}}return{value:this._getComboBox().getValue()}};n.prototype.setValueFromOutside=function(e){const t=a.resolveValue(e,this.getCardInstance());l.setValueAndKey(this._getComboBox(),t?.selectedKey,t?.value);this._syncValue()};n.prototype.getStaticConfiguration=function(){const e=this.getParsedConfiguration();let t="/";let o=[];let i;if(e.item&&e.item.path){t=e.item.path}const l=this.getModel().getProperty(t);if(e.item&&e.item.template){i=e.item.template;o=l.map(function(e,o){const l=t==="/"?t+o:t+"/"+o;return a.resolveValue(i,this,l)}.bind(this))}else{o=l}o=o.map(e=>({key:e.key&&e.key.toString(),title:e.title&&e.title.toString(),additionalText:e.additionalText&&e.additionalText.toString()}));const n=s({},e);delete n.item;n.items=o;const r=this.getValueForModel();n.value=r.value;n.selectedKey=r.selectedItem?.key;return n};n.prototype.writeValueToConfiguration=function(e){const t=this.getValueForModel();e.value=t.value;if(t.selectedItem){e.selectedKey=t.selectedItem.key}};n.prototype._getComboBox=function(){let e=this.getAggregation("_comboBox");if(!e){e=this._createComboBox();this.setAggregation("_comboBox",e)}return e};n.prototype._createComboBox=function(){const e=this.getConfig();const s=new t({placeholder:e.placeholder,showSecondaryValues:true,filterSecondaryValues:true,customSelectedIndex:e.selectedIndex});let n,r,m,d="/";s.attachChange(e=>{this._syncValue()});if(e&&e.item){d=e.item.path||d}if(e&&e.item&&e.item.template){n=e.item.template.key;r=e.item.template.title;m=e.item.template.additionalText}const u=this.getCardInstance();if(e&&e.items){n="{key}";r="{title}";m="{additionalText}";const t=new i(e.items);t.setSizeLimit(u.getModelSizeLimit());this.setModel(t)}this._oItemTemplate=new o({key:n,text:r,additionalText:m});s.bindItems({path:d,template:this._oItemTemplate});l.setValueAndKey(s,a.resolveValue(e.selectedKey,u),a.resolveValue(e.value,u));const c=this.createLabel(e);if(c){s.addAriaLabelledBy(c)}return s};return n});
//# sourceMappingURL=ComboBoxFilter.js.map